version: "3.7"

services:
  momomo:
    image: alexmikhalochkin/momomo-worker:${MOMOMO_IMAGE_TAG}
    container_name: momomo
    environment:
      - TZ=${TIMEZONE}
    volumes:
      - ${MOMOMO_CONFIGURATION_DIRECTORY}:/config
    command: --spring.config.location=/config/
    restart: unless-stopped

  mosquitto:
    image: eclipse-mosquitto
    hostname: mosquitto
    container_name: mosquitto
    ports:
      - "1883:1883"
      - "9001:9001"
    volumes:
      - ${AWS_IOT_CONFIGURATION_DIRECTORY}:/etc/mosquitto
      - ${AWS_IOT_MOSQUITTO_CONFIGURATION_FILE}:/mosquitto/config/mosquitto.conf
    command: >
      /bin/sh -c "/usr/sbin/mosquitto -c /mosquitto/config/mosquitto.conf 2>&1 | grep -v 'PING'"
    restart: unless-stopped

  plex:
    image: lscr.io/linuxserver/plex:${PLEX_IMAGE_TAG}
    container_name: plex
    network_mode: host
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=${TIMEZONE}
      - VERSION=docker
      - PLEX_CLAIM= #optional
    volumes:
      - ${PLEX_CONTENT_DIRECTORY}/library:/config
      - ${PLEX_CONTENT_DIRECTORY}/tvseries:/tv
      - ${PLEX_CONTENT_DIRECTORY}/music:/music
      - ${PLEX_CONTENT_DIRECTORY}/movies:/movies
    restart: unless-stopped

  zigbee2mqtt:
    image: koenkk/zigbee2mqtt
    container_name: zigbee2mqtt
    environment:
      - TZ=${TIMEZONE}
    volumes:
      - ${ZIGBEE_2_MQTT_CONFIGURATION_DIRECTORY}:/app/data
      - /run/udev:/run/udev:ro
    ports:
      - "8080:8080"
    devices:
      - /dev/ttyUSB0:/dev/ttyUSB0
    restart: unless-stopped
